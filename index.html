<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia de Estudo: Uni√£o Ib√©rica (1580‚Äì1640)</title>
    <style>
        :root {
            --primary: #8B3A3A; /* Tom terracota/hist√≥rico */
            --secondary: #1F2937; /* Cinzento escuro */
            --accent: #D97706; /* Dourado */
            --bg-color: #F3F4F6;
            --text-color: #1F2937;
            --white: #FFFFFF;
            --success: #10B981;
            --error: #EF4444;
            --paper: #fdfbf7;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        /* Header */
        header {
            background-color: var(--primary);
            color: var(--white);
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Navigation */
        nav {
            background-color: var(--secondary);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            display: flex;
            justify-content: center;
            max-width: 1000px;
            margin: 0 auto;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: none;
            border: none;
            color: var(--white);
            padding: 1rem 2rem;
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: 600;
        }

        .nav-btn:hover {
            background-color: rgba(255,255,255,0.1);
        }

        .nav-btn.active {
            background-color: var(--accent);
            color: var(--white);
        }

        /* Bot√£o Certificado (Inicialmente Oculto) */
        #btn-certificado {
            display: none; 
            background-color: var(--success);
            color: white;
            animation: pulse 2s infinite;
        }
        
        #btn-certificado.visible {
            display: block;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Main Content */
        main {
            max-width: 1000px;
            margin: 2rem auto;
            padding: 0 1rem;
            min-height: 80vh;
        }

        .section-content {
            display: none;
            background: var(--white);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            animation: fadeIn 0.5s ease;
        }

        .section-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: var(--primary);
            border-bottom: 2px solid var(--accent);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            margin-top: 2rem;
        }
        
        h2:first-of-type {
            margin-top: 0;
        }

        h3 {
            color: var(--secondary);
            margin-bottom: 1rem;
            margin-top: 1.5rem;
            font-size: 1.3rem;
        }

        ul {
            list-style-position: inside;
            margin-left: 1rem;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        strong {
            color: var(--primary);
        }

        /* Analogia Box */
        .analogy-box {
            background-color: #FFFBEB;
            border-left: 4px solid var(--accent);
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 4px;
        }

        /* Quiz Styles */
        .question-block {
            margin-bottom: 2.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #eee;
        }

        .question-text {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        .options-container label {
            display: block;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .options-container label:hover {
            background: #f3f4f6;
            border-color: #d1d5db;
        }

        .options-container input {
            margin-right: 10px;
        }

        .feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 4px;
            display: none;
            font-size: 0.95rem;
        }

        .feedback.correct {
            background-color: #DCFCE7;
            color: #065F46;
            border: 1px solid #34D399;
            display: block;
        }

        .feedback.incorrect {
            background-color: #FEE2E2;
            color: #991B1B;
            border: 1px solid #F87171;
            display: block;
        }

        /* Drag and Drop Styles */
        .drag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 1rem;
        }

        .drag-column {
            flex: 1;
            min-width: 250px;
            background: #f8fafc;
            padding: 1rem;
            border-radius: 6px;
        }

        .draggable-item {
            background: white;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            cursor: pointer;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            transition: transform 0.2s, background-color 0.2s;
        }

        .draggable-item:hover {
            transform: translateX(5px);
        }

        .sortable-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sortable-item {
            background: white;
            border: 1px solid #e2e8f0;
            padding: 1rem;
            margin-bottom: 0.5rem;
            cursor: grab;
            display: flex;
            align-items: center;
            border-radius: 4px;
        }

        .btn-check {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.1rem;
            margin-top: 1rem;
            width: 100%;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .btn-check:hover {
            background-color: #702f2f;
        }

        /* GLOSSARY STYLES */
        .glossary-grid {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .glossary-item {
            background: #f9fafb;
            border-radius: 6px;
            border-left: 4px solid var(--primary);
            overflow: hidden;
            cursor: pointer;
            transition: box-shadow 0.3s;
        }

        .glossary-item:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .glossary-header {
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            color: var(--primary);
            font-size: 1.1rem;
        }

        .glossary-toggle {
            font-size: 1.5rem;
            line-height: 1;
            color: var(--accent);
            transition: transform 0.3s;
        }

        .glossary-content {
            max-height: 0;
            overflow: hidden;
            padding: 0 1.5rem;
            transition: all 0.3s ease-out;
            background-color: white;
            color: var(--secondary);
        }

        .glossary-item.expanded .glossary-toggle {
            transform: rotate(45deg);
        }

        .glossary-item.expanded .glossary-content {
            padding-bottom: 1.5rem;
            max-height: 200px;
            border-top: 1px solid #eee;
        }

        /* MULTIMEDIA STYLES */
        .media-container {
            background: #f8fafc;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            border: 1px solid #e2e8f0;
        }

        .media-label {
            display: block;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* CERTIFICATE STYLES */
        .certificate-wrapper {
            border: 10px double var(--primary);
            padding: 2rem;
            background-color: var(--paper);
            text-align: center;
            margin-top: 2rem;
            position: relative;
            background-image: radial-gradient(#e0dcd3 1px, transparent 0);
            background-size: 20px 20px;
        }

        .cert-header {
            font-family: "Times New Roman", serif;
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .cert-sub {
            font-size: 1.2rem;
            color: var(--secondary);
            margin-bottom: 2rem;
        }

        .cert-name {
            font-size: 2rem;
            font-family: "Cursive", serif; /* Fallback */
            border-bottom: 2px solid var(--secondary);
            display: inline-block;
            min-width: 300px;
            padding: 0 1rem;
            margin: 1rem 0;
            color: var(--accent);
        }

        .cert-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            max-width: 600px;
            margin: 2rem auto;
            background: white;
            padding: 1.5rem;
            border: 1px solid #ddd;
            box-shadow: 5px 5px 0px rgba(0,0,0,0.1);
        }

        .cert-stat-item {
            text-align: left;
            border-bottom: 1px solid #eee;
            padding: 0.5rem 0;
        }
        
        .cert-final {
            grid-column: 1 / -1;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 2px dashed var(--accent);
            color: var(--primary);
        }

        .cert-footer {
            margin-top: 2rem;
            font-size: 0.9rem;
            color: #666;
        }

        .input-name {
            padding: 1rem;
            font-size: 1.2rem;
            width: 100%;
            max-width: 400px;
            margin-bottom: 1rem;
            border: 2px solid var(--secondary);
            border-radius: 4px;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .nav-container {
                flex-direction: column;
            }
            .nav-btn {
                width: 100%;
                padding: 0.8rem;
            }
            .cert-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>

    <header>
        <h1>Guia de Estudo: Uni√£o Ib√©rica</h1>
        <p>Hist√≥ria de Portugal (1580‚Äì1640)</p>
    </header>

    <nav>
        <div class="nav-container">
            <!-- Multim√©dia Movido para o in√≠cio -->
            <button class="nav-btn" onclick="showSection('multimedia')">Multim√©dia</button>
            <button class="nav-btn active" onclick="showSection('guia')">Guia de Estudo</button>
            <button class="nav-btn" onclick="showSection('quiz')">Question√°rio</button>
            <button class="nav-btn" onclick="showSection('glossario')">Gloss√°rio & Exerc√≠cios</button>
            
            <!-- Bot√£o Certificado s√≥ aparece se desbloqueado -->
            <button id="btn-certificado" class="nav-btn" onclick="showSection('certificado')">‚òÖ Obter Certificado ‚òÖ</button>
        </div>
    </nav>

    <main>
        <!-- SEC√á√ÉO 1: GUIA DE ESTUDO -->
        <section id="guia" class="section-content active">
            
            <!-- Nova frase introdut√≥ria -->
            <p style="margin-bottom: 2rem; font-style: italic; color: var(--secondary); background: #e5e7eb; padding: 1rem; border-left: 4px solid var(--accent); border-radius: 4px;">
                Depois de consultares o V√≠deo Resumo ou o Podcast sobre a mat√©ria faz a revis√£o com o seguinte Guia de Estudo ...
            </p>

            <h2>1. Origens da Crise Sucess√≥ria e o In√≠cio da Uni√£o (1578‚Äì1581)</h2>
            <ul>
                <li><strong>A Trag√©dia Inicial:</strong> A crise come√ßou em <strong>1578</strong> com a derrota na <strong>Batalha de Alc√°cer Quibir</strong>, onde desapareceu o jovem rei <strong>D. Sebasti√£o</strong>.</li>
                <li><strong>Candidatos ao Trono:</strong> Ap√≥s a morte do Cardeal D. Henrique (1580), os principais candidatos eram <strong>D. Catarina de Bragan√ßa</strong>, <strong>Filipe II de Espanha</strong> e <strong>D. Ant√≥nio, Prior do Crato</strong>.</li>
                <li><strong>Apoio a Filipe II:</strong> Foi apoiado pela <strong>Nobreza, Alto Clero e Burguesia</strong>. Estes grupos esperavam estabilidade, novos neg√≥cios e acesso √† prata/ouro da Am√©rica espanhola.</li>
                <li><strong>Novo Rei:</strong> Filipe II de Espanha foi aclamado como <strong>Filipe I de Portugal</strong>.</li>
            </ul>

            <h2>2. A Funda√ß√£o da Uni√£o (Cortes de Tomar, 1581)</h2>
            <p>Nas Cortes de Tomar, Filipe I fez promessas fundamentais para garantir a aceita√ß√£o dos portugueses, estabelecendo uma uni√£o de duas coroas independentes:</p>
            <ul>
                <li>A l√≠ngua portuguesa continuaria a ser a oficial.</li>
                <li>A moeda portuguesa permaneceria a mesma.</li>
                <li>Os cargos administrativos seriam ocupados <strong>apenas por portugueses</strong>.</li>
                <li>Os territ√≥rios do Imp√©rio Portugu√™s continuariam sob governa√ß√£o portuguesa.</li>
            </ul>

            <h2>3. Causas da Destrui√ß√£o e Colapso Interno</h2>
            <ul>
                <li><strong>Viola√ß√£o das Promessas:</strong> O descontentamento cresceu porque os sucessores de Filipe I (Filipe III e IV de Espanha) come√ßaram a desrespeitar o juramento de Tomar.</li>
                <li><strong>Crise Econ√≥mica:</strong> Com a diminui√ß√£o da prata da Am√©rica, Espanha aumentou os <strong>impostos</strong> sobre Portugal e come√ßou a nomear espanh√≥is para cargos portugueses.</li>
                <li><strong>Revolta Popular:</strong> O descontentamento alastrou da elite para o povo. Exemplo: <strong>Revolta do Manuelinho</strong> em √âvora (1637), contra o aumento de impostos.</li>
            </ul>

            <h2>4. Fatores de Colapso Externo (Guerra Econ√≥mica)</h2>
            <ul>
                <li><strong>Novos Inimigos:</strong> Ao unir-se a Espanha, Portugal herdou os inimigos desta: <strong>Holanda, Inglaterra e Fran√ßa</strong>.</li>
                <li><strong>O Alvo:</strong> As col√≥nias e rotas comerciais portuguesas (Brasil, √Åfrica, Oriente) tornaram-se alvos leg√≠timos de ataque.</li>
                <li><strong>Arma Secreta:</strong> Holandeses e Ingleses usavam <strong>Companhias de Com√©rcio</strong> (empresas privadas com acionistas), que eram mais √°geis que o monop√≥lio estatal ib√©rico.</li>
                <li><strong>Desafio Ideol√≥gico:</strong> O jurista <strong>Hugo Gr√≥tios</strong> defendeu o <em>Mare Liberum</em> (Mar Livre), atacando a exclusividade do Tratado de Tordesilhas (<em>Mare Clausum</em>).</li>
            </ul>

            <div class="analogy-box">
                <h3>Analogia: O Choque de Modelos Econ√≥micos</h3>
                <p>O <strong>Modelo Ib√©rico</strong> era como um "navio-m√£e" gigante e lento: estatal, focado apenas em ouro/prata e dif√≠cil de manobrar. Se o Estado falhava, tudo parava.</p>
                <p>O <strong>Modelo do Norte (Holand√™s/Ingl√™s)</strong> era como um enxame de "lanchas r√°pidas": companhias privadas √°geis, financiadas por muitos investidores. Se uma falhasse, as outras continuavam a atacar e a lucrar.</p>
            </div>

            <h2>5. A Restaura√ß√£o de 1640</h2>
            <ul>
                <li><strong>A Fa√≠sca Final:</strong> A tentativa do <strong>Conde Duque de Olivares</strong> de recrutar nobres portugueses para combater na revolta da Catalunha.</li>
                <li><strong>O Golpe:</strong> A <strong>1 de dezembro de 1640</strong>, os "40 Conjurados" atacaram o Pa√ßo Real em Lisboa.</li>
                <li><strong>O Rei Restaurado:</strong> O Duque de Bragan√ßa foi aclamado como <strong>D. Jo√£o IV</strong>.</li>
                <li><strong>A Guerra:</strong> Seguiu-se a Guerra da Restaura√ß√£o, que durou 28 anos, at√© ao reconhecimento oficial por Espanha em <strong>1668</strong>.</li>
            </ul>
        </section>

        <!-- SEC√á√ÉO 2: QUESTION√ÅRIO -->
        <section id="quiz" class="section-content">
            <h2>Question√°rio de Avalia√ß√£o</h2>
            <p style="margin-bottom: 2rem;">Responda √†s 15 quest√µes para testar o seu conhecimento. (Valer√° para o certificado final)</p>

            <form id="quiz-form" onsubmit="return false;">
                
                <!-- A. Escolha M√∫ltipla √önica -->
                <h3>A. Escolha M√∫ltipla</h3>
                
                <div class="question-block" id="q1">
                    <p class="question-text">1. Qual evento, em 1578, desencadeou diretamente a crise sucess√≥ria?</p>
                    <div class="options-container">
                        <label><input type="radio" name="q1" value="a"> Morte do Cardeal D. Henrique</label>
                        <label><input type="radio" name="q1" value="b"> Batalha de Alc√°cer Quibir</label>
                        <label><input type="radio" name="q1" value="c"> Cortes de Tomar</label>
                    </div>
                    <div class="feedback" id="fb-q1"></div>
                </div>

                <div class="question-block" id="q2">
                    <p class="question-text">2. Qual era o principal objetivo de Hugo Gr√≥tios com o "Mare Liberum"?</p>
                    <div class="options-container">
                        <label><input type="radio" name="q2" value="a"> Defender o Tratado de Tordesilhas</label>
                        <label><input type="radio" name="q2" value="b"> Apoiar o monop√≥lio espanhol</label>
                        <label><input type="radio" name="q2" value="c"> Defender a liberdade de navega√ß√£o e com√©rcio para todos</label>
                    </div>
                    <div class="feedback" id="fb-q2"></div>
                </div>

                <div class="question-block" id="q3">
                    <p class="question-text">3. Qual foi uma promessa central das Cortes de Tomar violada por Madrid?</p>
                    <div class="options-container">
                        <label><input type="radio" name="q3" value="a"> Cargos administrativos apenas para portugueses</label>
                        <label><input type="radio" name="q3" value="b"> Uni√£o total dos ex√©rcitos</label>
                        <label><input type="radio" name="q3" value="c"> Ado√ß√£o do castelhano como l√≠ngua oficial</label>
                    </div>
                    <div class="feedback" id="fb-q3"></div>
                </div>

                <div class="question-block" id="q4">
                    <p class="question-text">4. Qual o nome da revolta popular em √âvora (1637)?</p>
                    <div class="options-container">
                        <label><input type="radio" name="q4" value="a"> Revolta das Sisas</label>
                        <label><input type="radio" name="q4" value="b"> Revolta do Manuelinho</label>
                        <label><input type="radio" name="q4" value="c"> Revolta da Catalunha</label>
                    </div>
                    <div class="feedback" id="fb-q4"></div>
                </div>

                <div class="question-block" id="q5">
                    <p class="question-text">5. Em que ano exato ocorreu a Restaura√ß√£o da Independ√™ncia?</p>
                    <div class="options-container">
                        <label><input type="radio" name="q5" value="a"> 1580</label>
                        <label><input type="radio" name="q5" value="b"> 1640</label>
                        <label><input type="radio" name="q5" value="c"> 1668</label>
                    </div>
                    <div class="feedback" id="fb-q5"></div>
                </div>

                <!-- B. Escolha M√∫ltipla (V√°rias Op√ß√µes) -->
                <h3>B. Sele√ß√£o M√∫ltipla (Selecione todas as corretas)</h3>

                <div class="question-block" id="q6">
                    <p class="question-text">6. Quem apoiou Filipe II na sua subida ao trono?</p>
                    <div class="options-container">
                        <label><input type="checkbox" name="q6" value="a"> Alto Clero e Nobreza</label>
                        <label><input type="checkbox" name="q6" value="b"> O Povo (apoiantes de D. Ant√≥nio)</label>
                        <label><input type="checkbox" name="q6" value="c"> Burguesia (interessada em neg√≥cios)</label>
                    </div>
                    <div class="feedback" id="fb-q6"></div>
                </div>

                <div class="question-block" id="q7">
                    <p class="question-text">7. Caracter√≠sticas do modelo econ√≥mico do Norte da Europa:</p>
                    <div class="options-container">
                        <label><input type="checkbox" name="q7" value="a"> Uso de Companhias de Com√©rcio privadas</label>
                        <label><input type="checkbox" name="q7" value="b"> Controlo estatal r√≠gido e pesado</label>
                        <label><input type="checkbox" name="q7" value="c"> Focado em transporte, finan√ßas e dinamismo</label>
                    </div>
                    <div class="feedback" id="fb-q7"></div>
                </div>

                <div class="question-block" id="q8">
                    <p class="question-text">8. A√ß√µes que violaram as Cortes de Tomar:</p>
                    <div class="options-container">
                        <label><input type="checkbox" name="q8" value="a"> Lan√ßamento de impostos pesados para guerras espanholas</label>
                        <label><input type="checkbox" name="q8" value="b"> Nomea√ß√£o de espanh√≥is para cargos portugueses</label>
                        <label><input type="checkbox" name="q8" value="c"> Manuten√ß√£o da l√≠ngua portuguesa</label>
                    </div>
                    <div class="feedback" id="fb-q8"></div>
                </div>

                <!-- C. Verdadeiro ou Falso -->
                <h3>C. Verdadeiro ou Falso</h3>

                <div class="question-block" id="q9">
                    <p class="question-text">9. A Uni√£o Ib√©rica foi vista inicialmente como uma uni√£o de reinos iguais (monarquia dual), e n√£o como uma conquista.</p>
                    <div class="options-container">
                        <label><input type="radio" name="q9" value="true"> Verdadeiro</label>
                        <label><input type="radio" name="q9" value="false"> Falso</label>
                    </div>
                    <div class="feedback" id="fb-q9"></div>
                </div>

                <div class="question-block" id="q10">
                    <p class="question-text">10. A nomea√ß√£o de portugueses para cargos p√∫blicos foi estritamente cumprida por Madrid at√© 1640.</p>
                    <div class="options-container">
                        <label><input type="radio" name="q10" value="true"> Verdadeiro</label>
                        <label><input type="radio" name="q10" value="false"> Falso</label>
                    </div>
                    <div class="feedback" id="fb-q10"></div>
                </div>

                <div class="question-block" id="q11">
                    <p class="question-text">11. A guerra de restaura√ß√£o durou menos de 10 anos.</p>
                    <div class="options-container">
                        <label><input type="radio" name="q11" value="true"> Verdadeiro</label>
                        <label><input type="radio" name="q11" value="false"> Falso</label>
                    </div>
                    <div class="feedback" id="fb-q11"></div>
                </div>

                <!-- D. Drag & Drop (Correspond√™ncia) -->
                <h3>D. Associa√ß√£o de Termos</h3>
                <p>Selecione um termo na coluna da esquerda e depois clique na descri√ß√£o correspondente na direita.</p>

                <div class="question-block" id="q12">
                    <div class="drag-container">
                        <div class="drag-column" id="col-terms-12"></div>
                        <div class="drag-column" id="col-desc-12"></div>
                    </div>
                    <div class="feedback" id="fb-q12"></div>
                </div>

                <div class="question-block" id="q13">
                    <p class="question-text">Associa√ß√£o Grupo 2:</p>
                    <div class="drag-container">
                        <div class="drag-column" id="col-terms-13"></div>
                        <div class="drag-column" id="col-desc-13"></div>
                    </div>
                    <div class="feedback" id="fb-q13"></div>
                </div>

                <!-- E. Ordena√ß√£o Cronol√≥gica -->
                <h3>E. Ordena√ß√£o Cronol√≥gica</h3>
                <p>Use as setas para colocar os eventos na ordem correta (do mais antigo para o mais recente).</p>

                <div class="question-block" id="q14">
                    <ul class="sortable-list" id="sort-q14"></ul>
                    <div class="feedback" id="fb-q14"></div>
                </div>

                <div class="question-block" id="q15">
                    <ul class="sortable-list" id="sort-q15"></ul>
                    <div class="feedback" id="fb-q15"></div>
                </div>

                <button class="btn-check" onclick="checkQuiz()">Submeter Question√°rio e Ver Pontua√ß√£o</button>

                <div id="quiz-status-msg" style="display:none; margin-top: 1rem; text-align:center; font-weight:bold; color: var(--primary);">
                    Question√°rio Conclu√≠do! Pontua√ß√£o salva. Complete agora o Gloss√°rio.
                </div>

            </form>
        </section>

        <!-- SEC√á√ÉO 3: GLOSS√ÅRIO INTERATIVO E EXERC√çCIOS -->
        <section id="glossario" class="section-content">
            <h2>Gloss√°rio Interativo</h2>
            <p>Clique nos termos para expandir as defini√ß√µes.</p>
            <div class="glossary-grid" id="glossary-container"></div>

            <h2 style="margin-top: 4rem; color: var(--primary); border-bottom: 2px solid var(--accent);">5 Exerc√≠cios de Consolida√ß√£o</h2>
            <p>Para obter o certificado final, complete os 5 exerc√≠cios abaixo.</p>

            <!-- Exerc√≠cio 1 -->
            <div class="question-block" id="g1-block" style="margin-top: 2rem;">
                <h3>1. Conceitos Chave</h3>
                <p>Associe o conceito √† sua defini√ß√£o:</p>
                <div class="drag-container">
                    <div class="drag-column" id="col-terms-g1"></div>
                    <div class="drag-column" id="col-desc-g1"></div>
                </div>
            </div>

            <!-- Exerc√≠cio 2 -->
            <div class="question-block" id="g2-block">
                <h3>2. Personagens Hist√≥ricas</h3>
                <p>Quem √© quem na crise sucess√≥ria?</p>
                <div class="drag-container">
                    <div class="drag-column" id="col-terms-g2"></div>
                    <div class="drag-column" id="col-desc-g2"></div>
                </div>
            </div>

            <!-- Exerc√≠cio 3 -->
            <div class="question-block" id="g3-block">
                <h3>3. Datas Importantes</h3>
                <p>Ligue o ano ao acontecimento:</p>
                <div class="drag-container">
                    <div class="drag-column" id="col-terms-g3"></div>
                    <div class="drag-column" id="col-desc-g3"></div>
                </div>
            </div>

             <!-- Exerc√≠cio 4 -->
             <div class="question-block" id="g4-block">
                <h3>4. Economia e Pol√≠tica</h3>
                <p>Associe as causas e consequ√™ncias:</p>
                <div class="drag-container">
                    <div class="drag-column" id="col-terms-g4"></div>
                    <div class="drag-column" id="col-desc-g4"></div>
                </div>
            </div>

            <!-- Exerc√≠cio 5 -->
            <div class="question-block" id="g5-block">
                <h3>5. Geografia e Diplomacia</h3>
                <p>Ligue os locais/conceitos ao seu significado:</p>
                <div class="drag-container">
                    <div class="drag-column" id="col-terms-g5"></div>
                    <div class="drag-column" id="col-desc-g5"></div>
                </div>
            </div>

            <button class="btn-check" onclick="checkGlossary()">Submeter Exerc√≠cios do Gloss√°rio</button>
            <div id="glossary-feedback-final" class="feedback" style="text-align: center; margin-top:1rem;"></div>

        </section>

        <!-- SEC√á√ÉO 4: MULTIM√âDIA (NOVO) -->
        <section id="multimedia" class="section-content">
            <h2>Recursos Multim√©dia</h2>
            <p>Aprofunde os seus conhecimentos atrav√©s destes recursos audiovisuais.</p>

            <div class="media-container">
                <span class="media-label">üé¨ V√≠deo: A Revolta de 1640</span>
                <video width="100%" height="auto" controls style="border-radius: 8px; margin-top: 0.5rem; background: #000;">
                    <source src="./1640.mp4" type="video/mp4">
                    O seu navegador n√£o suporta a reprodu√ß√£o de v√≠deo.
                </video>
                <p style="margin-top: 0.5rem; font-size: 0.9rem; opacity: 0.8;">Um olhar visual sobre os acontecimentos do 1¬∫ de Dezembro.</p>
            </div>

            <div class="media-container">
                <span class="media-label">üéß Podcast: O Caminho para a Independ√™ncia</span>
                <audio controls style="width: 100%; margin-top: 0.5rem;">
                    <source src="./1640.mp3" type="audio/mpeg">
                    O seu navegador n√£o suporta o elemento de √°udio.
                </audio>
                <p style="margin-top: 0.5rem; font-size: 0.9rem; opacity: 0.8;">Ou√ßa a an√°lise detalhada sobre o contexto pol√≠tico da √©poca.</p>
            </div>
        </section>


        <!-- SEC√á√ÉO 5: CERTIFICADO (Inicialmente Vazio/Oculto) -->
        <section id="certificado" class="section-content">
            <h2>Certificado de Conclus√£o</h2>
            <p>Parab√©ns por concluir todas as atividades! Preencha o seu nome para gerar o certificado oficial.</p>
            
            <div style="text-align: center; margin: 2rem 0;">
                <input type="text" id="user-name" class="input-name" placeholder="Escreva o seu nome completo aqui...">
                <button class="btn-check" style="width: auto; background-color: var(--accent);" onclick="generateCertificate()">Gerar Documento</button>
            </div>

            <div id="certificate-display" style="display:none;">
                <div class="certificate-wrapper">
                    <div class="cert-header">Certificado de Aproveitamento</div>
                    <div class="cert-sub">Guia de Estudo da Uni√£o Ib√©rica (1580‚Äì1640)</div>
                    
                    <p>Certifica-se que</p>
                    <div class="cert-name" id="cert-name-display">Nome do Aluno</div>
                    <p>concluiu com sucesso as atividades propostas.</p>

                    <div class="cert-stats">
                        <div class="cert-stat-item"><strong>Data:</strong> <span id="cert-date"></span></div>
                        <div class="cert-stat-item"><strong>Question√°rio:</strong> <span id="cert-score-quiz"></span></div>
                        <div class="cert-stat-item"><strong>Gloss√°rio (5 ex.):</strong> <span id="cert-score-gloss"></span></div>
                        <div class="cert-stat-item"><strong>Total Pontos:</strong> <span id="cert-score-total"></span></div>
                        
                        <div class="cert-final">
                            Classifica√ß√£o Final: <span id="cert-percent"></span><br>
                            <span id="cert-grade" style="font-size: 1.8rem; display:block; margin-top:0.5rem;"></span>
                        </div>
                    </div>

                    <div class="cert-footer">
                        <p>Este documento comprova a realiza√ß√£o das tarefas de estudo aut√≥nomo.</p>
                        <button onclick="window.print()" style="margin-top:1rem; padding:0.5rem 1rem; cursor:pointer;">Imprimir Certificado</button>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script>
        // --- ESTADO GLOBAL DA APLICA√á√ÉO ---
        const appState = {
            quizCompleted: false,
            quizScore: 0,
            glossaryCompleted: false,
            glossaryScore: 0,
            totalPossibleQuiz: 15,
            totalPossibleGlossary: 20 // 5 exerc√≠cios x 4 pontos (simb√≥lico, ou 4 itens cada)
        };

        // --- DADOS DO GLOSS√ÅRIO ---
        const glossaryData = [
            { term: "Uni√£o Ib√©rica", def: "Per√≠odo (1580-1640) em que Portugal e Espanha estiveram unidos sob a mesma coroa." },
            { term: "Imp√©rio onde o sol nunca se punha", def: "Imp√©rio Espanhol/Ib√©rico devido √† sua vasta extens√£o global." },
            { term: "D. Sebasti√£o", def: "Rei desaparecido em Alc√°cer Quibir (1578)." },
            { term: "Filipe I", def: "Rei que unificou a Pen√≠nsula, prometendo autonomia em Tomar." },
            { term: "Hugo Gr√≥tios", def: "Jurista que defendeu o 'Mare Liberum'." },
            { term: "Conjurados", def: "Nobres que planearam o golpe de 1640." },
            { term: "Olivares", def: "Ministro espanhol que tentou centralizar o poder." },
            { term: "Restaura√ß√£o", def: "Fim do dom√≠nio espanhol em 1640." }
        ];

        // --- DADOS PARA EXERC√çCIOS DO GLOSS√ÅRIO (5 GRUPOS) ---
        const g1Data = [
            { term: "Mare Liberum", desc: "O mar √© livre para todos navegarem." },
            { term: "Monarquia Dual", desc: "Dois reinos, um rei, leis separadas." },
            { term: "Mare Clausum", desc: "Exclusividade de navega√ß√£o (Tordesilhas)." },
            { term: "Companhias", desc: "Empresas privadas com acionistas." }
        ];
        const g2Data = [
            { term: "D. Sebasti√£o", desc: "O Desejado, desapareceu em √Åfrica." },
            { term: "D. Ant√≥nio", desc: "Prior do Crato, candidato popular." },
            { term: "Filipe II (Esp)", desc: "Tornou-se Filipe I de Portugal." },
            { term: "Duque de Bragan√ßa", desc: "Tornou-se D. Jo√£o IV em 1640." }
        ];
        const g3Data = [
            { term: "1578", desc: "Batalha de Alc√°cer Quibir." },
            { term: "1580", desc: "Morte do Cardeal D. Henrique." },
            { term: "1637", desc: "Revolta do Manuelinho." },
            { term: "1640", desc: "Restaura√ß√£o da Independ√™ncia." }
        ];
        const g4Data = [
            { term: "Modelo Ib√©rico", desc: "Estatal, lento, focado em metais." },
            { term: "Modelo Norte", desc: "Din√¢mico, privado, focado em com√©rcio." },
            { term: "Impostos", desc: "Aumentaram para pagar guerras espanholas." },
            { term: "Prata", desc: "Sua escassez causou crise em Espanha." }
        ];
        const g5Data = [
            { term: "Cortes de Tomar", desc: "Onde se selou o pacto da Uni√£o." },
            { term: "√âvora", desc: "Centro da Revolta do Manuelinho." },
            { term: "Holanda", desc: "Principal rival e atacante das col√≥nias." },
            { term: "Brasil", desc: "Territ√≥rio atacado pelos holandeses." }
        ];


        // --- NAVEGA√á√ÉO E UI ---
        function showSection(id) {
            document.querySelectorAll('.section-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            
            document.getElementById(id).classList.add('active');
            const buttons = document.querySelectorAll('.nav-btn');
            
            // Actualizada a ordem dos bot√µes: Multim√©dia -> Guia -> Quiz -> Gloss√°rio
            if(id === 'multimedia') buttons[0].classList.add('active');
            if(id === 'guia') buttons[1].classList.add('active');
            if(id === 'quiz') buttons[2].classList.add('active');
            if(id === 'glossario') buttons[3].classList.add('active');
            if(id === 'certificado') document.getElementById('btn-certificado').classList.add('active');
        }

        function checkUnlockCertificate() {
            if (appState.quizCompleted && appState.glossaryCompleted) {
                const btn = document.getElementById('btn-certificado');
                btn.classList.add('visible');
                // Opcional: alert("Parab√©ns! Desbloqueou o Certificado Final. Verifique o menu.");
            }
        }

        // --- INICIALIZA√á√ÉO ---
        window.onload = function() {
            // Render Gloss√°rio
            const glossaryContainer = document.getElementById('glossary-container');
            glossaryContainer.innerHTML = glossaryData.map(item => `
                <div class="glossary-item" onclick="toggleGlossary(this)">
                    <div class="glossary-header">
                        <span class="glossary-term">${item.term}</span>
                        <span class="glossary-toggle">+</span>
                    </div>
                    <div class="glossary-content"><p>${item.def}</p></div>
                </div>
            `).join('');

            // Inicializar Drag & Drop do Quiz
            const quizAssoc12 = [
                { term: "Cortes de Tomar", desc: "Local onde Filipe I fez promessas." },
                { term: "Companhias", desc: "Empresas privadas √°geis." }
            ];
            const quizAssoc13 = [
                { term: "Olivares", desc: "Provocou a revolta da Catalunha." },
                { term: "D. Jo√£o IV", desc: "Rei aclamado em 1640." }
            ];
            renderAssociation('col-terms-12', 'col-desc-12', quizAssoc12, 'q12');
            renderAssociation('col-terms-13', 'col-desc-13', quizAssoc13, 'q13');

            // Inicializar Drag & Drop do Gloss√°rio (5 exerc√≠cios)
            renderAssociation('col-terms-g1', 'col-desc-g1', g1Data, 'g1');
            renderAssociation('col-terms-g2', 'col-desc-g2', g2Data, 'g2');
            renderAssociation('col-terms-g3', 'col-desc-g3', g3Data, 'g3');
            renderAssociation('col-terms-g4', 'col-desc-g4', g4Data, 'g4');
            renderAssociation('col-terms-g5', 'col-desc-g5', g5Data, 'g5');

            // Ordena√ß√£o Quiz
            const orderData14 = [
                { id: "A", text: "Desaparecimento de D. Sebasti√£o (1578)" },
                { id: "B", text: "Morte do Cardeal D. Henrique (1580)" },
                { id: "C", text: "Cortes de Tomar (1581)" }
            ];
            const orderData15 = [
                { id: "A", text: "Revolta do Manuelinho (1637)" },
                { id: "B", text: "Restaura√ß√£o (1640)" },
                { id: "C", text: "Paz com Espanha (1668)" }
            ];
            renderSortable('sort-q14', orderData14.sort(() => Math.random() - 0.5));
            renderSortable('sort-q15', orderData15.sort(() => Math.random() - 0.5));
        };

        // --- L√ìGICA VISUAL ---
        function toggleGlossary(element) {
            element.classList.toggle('expanded');
            const toggleBtn = element.querySelector('.glossary-toggle');
            toggleBtn.textContent = element.classList.contains('expanded') ? '‚àí' : '+';
        }

        let selectedTerm = null;

        function renderAssociation(termColId, descColId, data, qPrefix) {
            const termContainer = document.getElementById(termColId);
            const descContainer = document.getElementById(descColId);
            
            let terms = [...data].sort(() => Math.random() - 0.5);
            let descs = [...data].sort(() => Math.random() - 0.5);

            termContainer.innerHTML = terms.map(item => 
                `<div class="draggable-item term-item" data-term="${item.term}" onclick="selectTerm(this, '${qPrefix}')">${item.term}</div>`
            ).join('');

            descContainer.innerHTML = descs.map(item => 
                `<div class="draggable-item desc-item" data-correct="${item.term}" onclick="matchDesc(this, '${qPrefix}')">${item.desc}</div>`
            ).join('');
        }

        function selectTerm(el, prefix) {
            const containerId = el.parentElement.id;
            document.querySelectorAll(`#${containerId} .term-item`).forEach(t => {
                t.style.borderColor = '#e2e8f0';
                t.style.backgroundColor = 'white';
            });
            
            el.style.borderColor = '#D97706';
            el.style.backgroundColor = '#FEF3C7';
            selectedTerm = { el: el, term: el.dataset.term, prefix: prefix };
        }

        function matchDesc(el, prefix) {
            if (!selectedTerm || selectedTerm.prefix !== prefix) return;

            el.dataset.userGuess = selectedTerm.term;
            const containerId = el.parentElement.id;
            
            // Limpar anteriores
            document.querySelectorAll(`#${containerId} .desc-item`).forEach(d => {
                if(d.dataset.userGuess === selectedTerm.term && d !== el) delete d.dataset.userGuess; 
            });

            el.style.borderColor = '#D97706';
            el.innerHTML = `<strong>[${selectedTerm.term}]</strong> ${el.innerText.replace(/^\[.*?\] /, '')}`;
            
            selectedTerm.el.style.borderColor = '#10B981';
            selectedTerm.el.style.backgroundColor = '#ECFDF5';
            selectedTerm = null;
        }

        function renderSortable(containerId, data) {
            const container = document.getElementById(containerId);
            container.innerHTML = data.map(item => `
                <li class="sortable-item" data-id="${item.id}">
                    <div style="display:flex; flex-direction:column; margin-right:10px;">
                        <button type="button" onclick="moveUp(this)">&#9650;</button>
                        <button type="button" onclick="moveDown(this)">&#9660;</button>
                    </div>
                    ${item.text}
                </li>
            `).join('');
        }

        function moveUp(btn) {
            const li = btn.closest('li');
            if (li.previousElementSibling) li.parentNode.insertBefore(li, li.previousElementSibling);
        }
        function moveDown(btn) {
            const li = btn.closest('li');
            if (li.nextElementSibling) li.parentNode.insertBefore(li.nextElementSibling, li);
        }

        // --- VERIFICA√á√ÉO QUIZ ---
        function checkQuiz() {
            let score = 0;
            const feedback = (id, isCorrect, msg) => {
                const el = document.getElementById('fb-' + id);
                if(el) {
                    el.className = isCorrect ? 'feedback correct' : 'feedback incorrect';
                    el.style.display = 'block';
                    el.innerHTML = isCorrect ? `<strong>Correto!</strong>` : `<strong>Incorreto.</strong> ${msg}`;
                }
            };

            // Q1-Q5 (Radio)
            if (document.querySelector('input[name="q1"]:checked')?.value === 'b') score++; else feedback('q1', false, 'Alc√°cer Quibir.');
            if (document.querySelector('input[name="q2"]:checked')?.value === 'c') score++; else feedback('q2', false, 'Liberdade de navega√ß√£o.');
            if (document.querySelector('input[name="q3"]:checked')?.value === 'a') score++; else feedback('q3', false, 'Cargos para portugueses.');
            if (document.querySelector('input[name="q4"]:checked')?.value === 'b') score++; else feedback('q4', false, 'Revolta do Manuelinho.');
            if (document.querySelector('input[name="q5"]:checked')?.value === 'b') score++; else feedback('q5', false, '1640.');

            // Q6-Q8 (Checkboxes - Simplified logic: needs all correct to get point)
            const q6 = Array.from(document.querySelectorAll('input[name="q6"]:checked')).map(e=>e.value);
            if (q6.includes('a') && q6.includes('c') && q6.length === 2) score++; else feedback('q6', false, 'Nobreza, Clero e Burguesia.');
            
            const q7 = Array.from(document.querySelectorAll('input[name="q7"]:checked')).map(e=>e.value);
            if (q7.includes('a') && q7.includes('c') && q7.length === 2) score++; else feedback('q7', false, 'Companhias privadas e dinamismo.');
            
            const q8 = Array.from(document.querySelectorAll('input[name="q8"]:checked')).map(e=>e.value);
            if (q8.includes('a') && q8.includes('b') && q8.length === 2) score++; else feedback('q8', false, 'Impostos e cargos.');

            // Q9-Q11 (V/F)
            if (document.querySelector('input[name="q9"]:checked')?.value === 'true') score++; else feedback('q9', false, 'Verdadeiro.');
            if (document.querySelector('input[name="q10"]:checked')?.value === 'false') score++; else feedback('q10', false, 'Falso.');
            if (document.querySelector('input[name="q11"]:checked')?.value === 'false') score++; else feedback('q11', false, 'Falso.');

            // Q12-Q13 (Assoc)
            let q12Ok = true;
            document.querySelectorAll('#col-desc-12 .desc-item').forEach(el => { if(el.dataset.userGuess !== el.dataset.correct) q12Ok = false; });
            if (document.querySelectorAll('#col-desc-12 .desc-item[data-user-guess]').length === 2 && q12Ok) score++; else feedback('q12', false, 'Reveja.');

            let q13Ok = true;
            document.querySelectorAll('#col-desc-13 .desc-item').forEach(el => { if(el.dataset.userGuess !== el.dataset.correct) q13Ok = false; });
            if (document.querySelectorAll('#col-desc-13 .desc-item[data-user-guess]').length === 2 && q13Ok) score++; else feedback('q13', false, 'Reveja.');

            // Q14-Q15 (Order)
            const q14 = Array.from(document.querySelectorAll('#sort-q14 li')).map(li => li.dataset.id).join('');
            if(q14 === 'ABC') score++; else feedback('q14', false, 'Ordem incorreta.');
            
            const q15 = Array.from(document.querySelectorAll('#sort-q15 li')).map(li => li.dataset.id).join('');
            if(q15 === 'ABC') score++; else feedback('q15', false, 'Ordem incorreta.');

            // SAVE STATE
            appState.quizScore = score;
            appState.quizCompleted = true;

            const msg = document.getElementById('quiz-status-msg');
            msg.style.display = 'block';
            msg.innerText = `Question√°rio submetido! Sua pontua√ß√£o: ${score}/15. Continue para o Gloss√°rio.`;
            
            checkUnlockCertificate();
        }

        // --- VERIFICA√á√ÉO GLOSS√ÅRIO (5 Exerc√≠cios) ---
        function checkGlossary() {
            let score = 0;
            let allAttempted = true;
            const exercises = ['g1', 'g2', 'g3', 'g4', 'g5'];
            const maxPointsPerExercise = 4; // 1 point per correct pair within the exercise

            // Reset styles
            document.querySelectorAll('#glossario .desc-item').forEach(el => {
                el.style.border = '1px solid #e2e8f0';
            });

            exercises.forEach(exId => {
                const items = document.querySelectorAll(`#col-desc-${exId} .desc-item`);
                let correctCount = 0;
                let attemptedCount = 0;

                items.forEach(el => {
                    if (el.dataset.userGuess) {
                        attemptedCount++;
                        if (el.dataset.userGuess === el.dataset.correct) {
                            correctCount++;
                            el.style.border = '2px solid var(--success)'; // Visual feedback correct
                        } else {
                            el.style.border = '2px solid var(--error)'; // Visual feedback wrong
                        }
                    }
                });

                if (attemptedCount < items.length) allAttempted = false;
                score += correctCount; // Add correct pairs to total score
            });

            const fb = document.getElementById('glossary-feedback-final');
            fb.style.display = 'block';

            if (!allAttempted) {
                fb.className = 'feedback incorrect';
                fb.innerText = "Aten√ß√£o: Ainda n√£o associou todos os termos em todos os 5 exerc√≠cios.";
                return;
            }

            appState.glossaryScore = score;
            appState.glossaryCompleted = true;
            
            fb.className = 'feedback correct';
            fb.innerHTML = `<strong>Exerc√≠cios Conclu√≠dos!</strong> Pontua√ß√£o obtida: ${score} / 20.<br>Se j√° fez o quiz, o certificado est√° agora dispon√≠vel no topo da p√°gina.`;

            checkUnlockCertificate();
        }

        // --- GERAR CERTIFICADO ---
        function generateCertificate() {
            const name = document.getElementById('user-name').value;
            if (!name.trim()) {
                alert("Por favor, introduza o seu nome.");
                return;
            }

            // Calculate Totals
            const totalPoints = appState.quizScore + appState.glossaryScore;
            const maxPoints = appState.totalPossibleQuiz + appState.totalPossibleGlossary; // 15 + 20 = 35
            const percentage = Math.round((totalPoints / maxPoints) * 100);

            // Qualitative Scale
            let grade = "";
            if (percentage >= 100) grade = "Excelente";
            else if (percentage >= 90) grade = "Muito Bom";
            else if (percentage >= 70) grade = "Bom";
            else if (percentage >= 50) grade = "Satisfaz";
            else grade = "N√£o Satisfaz";

            // Render
            document.getElementById('cert-name-display').innerText = name;
            document.getElementById('cert-date').innerText = new Date().toLocaleDateString('pt-PT');
            document.getElementById('cert-score-quiz').innerText = `${appState.quizScore} / ${appState.totalPossibleQuiz}`;
            document.getElementById('cert-score-gloss').innerText = `${appState.glossaryScore} / ${appState.totalPossibleGlossary}`;
            document.getElementById('cert-score-total').innerText = totalPoints;
            document.getElementById('cert-percent').innerText = `${percentage}%`;
            
            const gradeEl = document.getElementById('cert-grade');
            gradeEl.innerText = grade;

            // Color coding grade
            if (percentage < 50) gradeEl.style.color = 'var(--error)';
            else if (percentage < 90) gradeEl.style.color = 'var(--accent)';
            else gradeEl.style.color = 'var(--success)';

            document.getElementById('certificate-display').style.display = 'block';
            document.getElementById('certificate-display').scrollIntoView({behavior: 'smooth'});
        }
    </script>
</body>
</html>